<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Double-Ended GSM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="page2">Double-Ended GSM </a></h1><h2><a class="anchor" id="sec">
Description</a></h2>
<p>DE GSM grows and optimizes a string of molecular geometries called nodes between a reactant and product pair and finds the exact transition state (TS) structure between them. This is done in two phases called the growth and optimization phase. The growth phase grows the string of nodes from the outside-in, and performs initial optimization. The optimization phase finishes optimizing the string and when the string is sufficiently optimized and behaving, the node with the highest energy is optimized to the exact transition state using climbing image and eigenvector following optimization. The driver for both DE and SE methods and growth and optimization phases is the <a class="el" href="classGString.html#a5c0f5979c54bcc11373ded4263e589f6">GString::String_Method_Optimization</a>.</p>
<h3><a class="anchor" id="subsection1">
Growth Phase</a></h3>
<p>The growth phase begins in <a class="el" href="classGString.html#a70d53028f0d8ded7424a39b0126da95d" title="Grows the initial nodes for SE and DE. nnodes is 4 for DE and 3 for SE.">GString::starting_string</a> which grows two nodes along the tangent vector connecting the reactant product pair, one on the reactant side and the other on the product side. The new nodes can be optimized subject to the tangent vector constraint, and a new tangent vector formed between them. Two more nodes can be added and the process repeated until the number of nodes requested are formed. A description of how delocalized internal coordinates, are formed and used to add nodes and perform constrained optimization is given in <a class="el" href="page1.html">Delocalized Internal Coordinates</a>.</p>
<p>The driver for adding nodes (<a class="el" href="classGString.html#ae3c17ae7b87ff084e5e2010883264c9f">GString::addNode</a>) and node optimization (<a class="el" href="classGString.html#af698100189b99cfb9f1b76a231d3e1b8">GString::opt_steps</a>) during the growth phase is <a class="el" href="classGString.html#ad80cccaa4ed2851c7b8e9bb8a9820a11">GString::growth_iters</a>. <a class="el" href="classGString.html#af698100189b99cfb9f1b76a231d3e1b8">GString::opt_steps</a> sends each active node to be optimized in <a class="el" href="classICoord.html#ad202e4c087b9f2a74bc543241bf3d91d" title="Optimizes the node subject to a constraint, nsteps times.">ICoord::opt_c</a>. In DE the added nodes are active, whereas in SE only frontier nodes are active (see <a class="el" href="page3.html">Single-Ended GSM</a>). The <a class="el" href="classICoord.html#ad202e4c087b9f2a74bc543241bf3d91d" title="Optimizes the node subject to a constraint, nsteps times.">ICoord::opt_c</a> function optimizes the node subject to the constraint, formed in <a class="el" href="classICoord.html#a356c38482ebd2f76f144a11b9fd5925d">ICoord::opt_constraint</a>. Each node is optimized at least one time and at most three times. If the node converges to within <a class="el" href="classGString.html#a0ee41c27cf94834f3fe6fac1927ec3fe">GString::CONV_TOL</a> it will optimize less than three times. The maximum number of iterations are hard-coded for DE but can be changed via the inpfileq for SE. <a class="el" href="classICoord.html#ad202e4c087b9f2a74bc543241bf3d91d" title="Optimizes the node subject to a constraint, nsteps times.">ICoord::opt_c</a> uses <a class="el" href="classICoord.html#a9217dea56e4358ed230921fb648816cf">ICoord::update_ic_eigen</a> to take Newton-Raphson Steps in the 3N-7 degrees of freedom corresponding to the nuclear space orthogonal to the constraint vector. <a class="el" href="classGString.html#a697be65171c98553206a5c10f05756de" title="reparametrizes the string along the constraint during the growth phase, only used...">GString::ic_reparam_g</a> repositions the nodes evenly along the string by adjusting the position of the nodes along the constraint vector.</p>
<h3><a class="anchor" id="subsection2">
Optimization Phase</a></h3>
<p><a class="el" href="classGString.html#a42ef6818143cd7d4b81928f725aae3ba">GString::opt_iters</a> is the driver for optimizing the string of nodes subject to the constraint vectors and for finding the exact TS structure. Finding the exact TS structure is done in two steps that locates the TS structure efficiently and eliminates the possibility the TS search finds the wrong TS structure. The first step is the climbing image and the second step is a modified eigenvector following optimization.</p>
<p>Climbing image allows the node corresponding the TS structure to move upward in energy towards the maximum using the component of the gradient that is in the direction of the reaction path. The maximum along the RP is a better structure for a local TS search. The local TS search is a modified eigenvector following approach. While conventional eigenvector following will ascend along the lowest eigenvalue vector of the Hessian, this criterion can be modified for increased stability since the approximate reaction path direction is known in GSM. To ensure that the correct mode is followed, the eigenvector of the Hessian with the highest overlap with the string tangent at the TS is targeted. Once the exact TS search commences, string optimization continues to proceed as usual. The TS node itself is not reparameterized, but equal spacing of nodes on either side of the string is still enforced (<a class="el" href="classGString.html#a75267fca06677d1b86a3fddc55c253ee" title="reparametrizes the string along the constraint after the growth phase">GString::ic_reparam</a>). Because the maximized eigenvector of the TS node must overlap with the reaction path tangent, the TS node remains effectively constrained within the reaction path.</p>
<p>Climbing image will be activated (<a class="el" href="classGString.html#a19e89d4666d739be84db8c83b6e65fe7">GString::climb</a> will equal 1) once the totalgrad &lt; 0.3 and one peak is found (<a class="el" href="classGString.html#aba28c6654e9bbcfcfc9af560645381b1" title="Finds peaks, used by opt_iters to know which node to climb.">GString::find_peaks</a>). When <a class="el" href="classGString.html#af698100189b99cfb9f1b76a231d3e1b8">GString::opt_steps</a> is called the function <a class="el" href="classGString.html#a74f195f43a267938610cf42a46989702">GString::get_tangents_1e</a> will form a three-way tangent on the TS node. This forms a more accurate RP direction for climbing image and approximating the Hessian. The function which performs the climbing image is <a class="el" href="classICoord.html#a65babeb7a48145edd9308dd6c82d8111">ICoord::walk_up</a>, and is called within <a class="el" href="classICoord.html#aa74c3e1dfb06f796c26d7c7663b96753">ICoord::update_ic_eigen_h</a>.</p>
<p>The local TS search (<a class="el" href="classGString.html#a69c8c8d4fa1c10392e1e721bc985b455">GString::find</a> = 1) will commence once the gradient of the TS node is small, the totalgrad is small, and the gradient in the direction of the RP at the TS node is smalll. <a class="el" href="classGString.html#a032391988ef02f56f9c8160f1ec30ed7" title="calls get_eigenv_finite after constructing tangent">GString::get_eigenv_finite</a> forms the eigenvectors corresponding to the imaginary frequencies. The eigenvector corresponding to the greatest overlap with the RP is used in the local TS search as described above. The function <a class="el" href="classICoord.html#a640a8b41acb347a2533cc307438f4c6d">ICoord::opt_eigen_ts</a> is responsible for performing the local TS search. Convergence of the reaction path is considered complete when the TS node has a small root mean squared (RMS) gradient of <a class="el" href="classGString.html#a0ee41c27cf94834f3fe6fac1927ec3fe">GString::CONV_TOL</a> (usually 0.0005 hartree/Å). The same RMS gradient threshold is used to temporarily cease node optimization during each string iteration.</p>
<h3><a class="anchor" id="ref2">
References:</a></h3>
<p>P. M. Zimmerman, “Reliable Transition State Searches Integrated with the Growing String Method,” Journal of Chemical Theory and Computation, 9, 3043-3050 (2013)<br/>
 <a href="http://pubs.acs.org.proxy.lib.umich.edu/doi/full/10.1021/ct400319w">http://pubs.acs.org.proxy.lib.umich.edu/doi/full/10.1021/ct400319w</a><br/>
 </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 17 Dec 2016 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
