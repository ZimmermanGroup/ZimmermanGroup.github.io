<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Delocalized Internal Coordinates</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="page1">Delocalized Internal Coordinates </a></h1><h2><a class="anchor" id="Overview">
Overview</a></h2>
<p>Delocalized internal coordinates are fundamental to the GSM because they enable direct and efficient constrained optimization. Furthermore, delocalized internal coordinates are a more natural coordinate system with less coupling in the Hessian because they are linear combinations of bonds, angles and torsions. Cartesian coordinates, on the other hand, are highly coupled coordinate system. On this page we will describe the generation of delocalized internal coordinatess, and how they are used in the GSM.</p>
<h3><a class="anchor" id="secg">
Generation</a></h3>
<p><a class="el" href="classGString.html#aaef64c4056df84b4f96f915560f3ee07">GString::structure_init</a> reads the xyzfile for the atom names and Cartesian coordinates. <a class="el" href="classICoord.html#a9f5e427537baf7eff321fc26bd5d76b2">ICoord::alloc</a> allocates memory and <a class="el" href="classICoord.html#af3518ca67d990218d25f1c429bb8ac77">ICoord::reset</a> sets the coordinates and atom information in the <a class="el" href="classICoord.html">ICoord</a> class. To construct delocalized internal coordinates, we require a complete set of internal coordinates. Internal coordinates are bonds, angles, and torsions and as such can be measured using atom-connectivity. The function responsible for forming the internal coorindates is <a class="el" href="classICoord.html#a048a2efb93d440aa8d9f0111e9efe457" title="creates the internal coordinates">ICoord::ic_create</a>. In DE GSM, <a class="el" href="classICoord.html#a05cff75b9528b697dd5702bd649921be">ICoord::union_ic</a> forms the union of reactant and product internal cooridnates as the full set of internal coordinates. The linear transformation describing the transformation from Cartesian coordinates to internal coordinates is the Wilson B matrix. <a class="el" href="classICoord.html#ab066e5d9d4422e90a2a9217fe1cfaa41">ICoord::bmat_alloc</a> allocates memory for the B matrix, delocalized internal coordinates U, and other important variables, and <a class="el" href="classICoord.html#ab57ab52efa83353ba7111498d3034c61" title="forms the original B matrix">ICoord::bmatp_create</a> creates the B matrix. The function <a class="el" href="classICoord.html#a05def41be55664df26b52a9e26b1fd36" title="Diagonalizes G to form U.">ICoord::bmatp_to_U</a> diagonalizes G=B<sup>T</sup>B to provide two sets of eigenvectors; a set of m=3N-6 eigenvectors with eigenvalues &gt;0 called U and a set of n-m eigenvectors with eigenvalues =0 (to numerical precision) called R. The set U exactly spans the 3N-6 molecular space and are therefore a non-redundant coordinate system. The coordinates U are saved as the transpose <a class="el" href="classICoord.html#a4e6250f414d55d5d17d074edc1a751a5">ICoord::Ut</a>. The component of each coordinate (<a class="el" href="classICoord.html#ac6605e2f376de0714eb515940f202491">ICoord::q</a>) in U is formed in <a class="el" href="classICoord.html#a905788953c1e0ec544d26ba9a8f718aa" title="Determines q the components of the molecular geometry in the DI space. Also forms...">ICoord::bmat_create</a>. Additionally, the B matrix—which was constructed from the original primitive internals—is transformed to the active coordinate set according to B=(U<sup>T</sup>)B<sup>p</sup>. This active B matrx is used by <a class="el" href="classICoord.html#ad9086b4eddc8813ecf290916c4c78d56" title="Transforms the gradient in Cartesian representation to delocalized internal coordinate...">ICoord::grad_to_q</a> to transform a gradient calculated in Cartesian coordinates, to a gradient described in delocalized internal coordinates. The back transformation from delocalized internal coordinates to Cartesian coordinates also uses the B matrix, and is performed in <a class="el" href="classICoord.html#a67d02ab8da8dba6b7d5a8fc585f18a37" title="back transforms from delocalized IC representation to Cartesian represention">ICoord::ic_to_xyz</a> and <a class="el" href="classICoord.html#a895b9385750bf5681fec06c52b334ce3">ICoord::ic_to_xyz_opt</a>.</p>
<h3><a class="anchor" id="secI">
Constrained Optimization and Linear Interpolation</a></h3>
<p>One of the main advantages of delocalized internal coordinates is their ease of use for constrained optimization and linear interpolation. Linear interpolation and constrained optimization begins by forming an internal coordinate constraint vector. In DE GSM, the constraint vector is the tangent vector between reactant and product, and is calculated by <a class="el" href="classGString.html#a45118033bfbb42936efc2210c9a30d55" title="Calculates the DE internal coordinate tangent vector.">GString::tangent_1</a>. In SE GSM the constraint vector is the driving coordinate scaled appropriately, and is calculated by <a class="el" href="classGString.html#aedb8a44bda2528441f6f5fa2eb9811aa" title="bond tangent for SSM">GString::tangent_1b</a>. The internal coordinate constraint vector is projected into the coordinate space defined by the primitive internal coordinates. A set V containting U and the constraint vector is formed. This set is redundant because it contains the 3N-6 non-redundant set U and the constraint vector. Therefore, it can be Schmidt orthogonalized to make the vectors U and the constraint vector orthogonal and the space non-redundant. This procedure is performed in <a class="el" href="classICoord.html#a356c38482ebd2f76f144a11b9fd5925d">ICoord::opt_constraint</a>. The new non-redundant molecular space obtained from <a class="el" href="classICoord.html#a356c38482ebd2f76f144a11b9fd5925d">ICoord::opt_constraint</a> contains 3N-7 adjustable degrees of freedom and one degree of freedom corresponding to the constraint vector. The constraint vector can either be kept constant to perform a constrained optimization, or incremented to linearly interpret along the constraint vector. Both are done in the GSM. Constrained optimization is performed in <a class="el" href="classICoord.html#ad202e4c087b9f2a74bc543241bf3d91d" title="Optimizes the node subject to a constraint, nsteps times.">ICoord::opt_c</a>, and linear interpolation is performed when adding nodes (<a class="el" href="classGString.html#a70d53028f0d8ded7424a39b0126da95d" title="Grows the initial nodes for SE and DE. nnodes is 4 for DE and 3 for SE.">GString::starting_string</a> and <a class="el" href="classGString.html#ae3c17ae7b87ff084e5e2010883264c9f">GString::addNode</a>), when reparametrizing the string (<a class="el" href="classGString.html#a697be65171c98553206a5c10f05756de" title="reparametrizes the string along the constraint during the growth phase, only used...">GString::ic_reparam_g</a> and <a class="el" href="classGString.html#a75267fca06677d1b86a3fddc55c253ee" title="reparametrizes the string along the constraint after the growth phase">GString::ic_reparam</a>), and when performing climbing image (<a class="el" href="classICoord.html#a65babeb7a48145edd9308dd6c82d8111">ICoord::walk_up</a>).</p>
<h3><a class="anchor" id="ref1">
References</a></h3>
<p>Baker, Jon and Kessi, Alain and Delley, Bernard, "The generation and use of delocalized internal coordinates in geometry optimization" The Journal of Chemical Physics, 105, 192-212 (1996), DOI:http://dx.doi.org/10.1063/1.471864<br/>
 <a href="http://scitation.aip.org/content/aip/journal/jcp/105/1/10.1063/1.471864">http://scitation.aip.org/content/aip/journal/jcp/105/1/10.1063/1.471864</a> </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 17 Dec 2016 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
